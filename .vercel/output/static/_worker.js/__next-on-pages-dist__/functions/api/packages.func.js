var V=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var ue=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var pe=(c,i)=>()=>(c&&(i=c(c=0)),i);var W=(c,i,K,b)=>{if(i&&typeof i=="object"||typeof i=="function")for(let y of ue(i))!ie.call(c,y)&&y!==K&&V(c,y,{get:()=>i[y],enumerable:!(b=ce(i,y))||b.enumerable});return c},J=(c,i,K)=>(W(c,i,"default"),K&&W(K,i,"default"));var ge=c=>W(V({},"__esModule",{value:!0}),c);var D={};import*as jt from"async_hooks";var Y=pe(()=>{J(D,jt)});import{__getNamedExports as de}from"../../../__next-on-pages-dist__/webpack/7528.js";import{__getNamedExports as he}from"../../../__next-on-pages-dist__/webpack/1d2470119d4f846d0a077893f2422c32.js";import{__getNamedExports as ke}from"../../../__next-on-pages-dist__/webpack/ac7e0cd817c0f96ac6506045b651299a.js";import{__getNamedExports as le}from"../../../__next-on-pages-dist__/webpack/841752b73933acd57f0d034e25bbec96.js";import{__getNamedExports as xe}from"../../../__next-on-pages-dist__/manifest/537259e2ed205f5a7994cb4f05664668.js";var l=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/packages"),me=de(l,l,l),fe=me.__chunk_7528,Q=he(l,l,l),be=Q.__chunk_9985,ye=Q.__chunk_4155,a=ke(l,l,l),ve=a.__chunk_6195,Ee=a.__chunk_2067,Ne=a.__chunk_9182,$e=a.__chunk_8983,Re=a.__chunk_5228,Pe=a.__chunk_2296,we=a.__chunk_2594,Oe=a.__chunk_6735,je=a.__chunk_8219,Se=a.__chunk_5577,Ie=a.__chunk_9254,Te=a.__chunk_9206,Ae=a.__chunk_989,Ce=a.__chunk_1863,Fe=a.__chunk_3039,Ke=a.__chunk_335,Me=a.__chunk_8042,Le=a.__chunk_7765,Ue=a.__chunk_6991,De=a.__chunk_8816,Be=a.__chunk_6631,qe=a.__chunk_4828,Xe=a.__chunk_4834,He=a.__chunk_828,Ge=a.__chunk_5927,We=a.__chunk_8439,Je=a.__chunk_4363,ze=a.__chunk_2039,Ve=a.__chunk_8264,Ye=a.__chunk_1583,Qe=a.__chunk_7908,Ze=a.__chunk_8949,et=a.__chunk_796,tt=a.__chunk_1651,nt=a.__chunk_5105,at=a.__chunk_9642,rt=a.__chunk_5028,st=a.__chunk_9548,_t=a.__chunk_6914,ot=a.__chunk_7960,ct=a.__chunk_4337,ut=a.__chunk_8819,x=le(l,l,l),it=x.__chunk_1730,pt=x.__chunk_3818,gt=x.__chunk_7037,dt=x.__chunk_9573,ht=x.__chunk_7701,kt=x.__chunk_662,lt=x.__chunk_4101,xt=x.__chunk_6776,mt=x.__chunk_3665,ft=x.__chunk_7444,bt=x.__chunk_4591,yt=x.__chunk_7983,vt=x.__chunk_5234,Et=x.__chunk_2561,Nt=x.__chunk_2988,$t=x.__chunk_5996,Rt=x.__chunk_676,Z=xe(l,l,l),Pt=Z.__NEXT_FONT_MANIFEST,wt=Z.__REACT_LOADABLE_MANIFEST,Ft=((c,i,K)=>(i._ENTRIES={},c.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-dedf763cc1ab7e12.js","static/chunks/fd9d1056-c9ed5066b0595dc4.js","static/chunks/30-d61876bacc5f7fe8.js","static/chunks/main-app-7952d10a904833a3.js"],pages:{"/_app":["static/chunks/webpack-dedf763cc1ab7e12.js","static/chunks/framework-f66176bb897dc684.js","static/chunks/main-bc32f17986994602.js","static/chunks/pages/_app-72b849fbd24ac258.js"],"/_error":["static/chunks/webpack-dedf763cc1ab7e12.js","static/chunks/framework-f66176bb897dc684.js","static/chunks/main-bc32f17986994602.js","static/chunks/pages/_error-7ba65e1336b92748.js"]},ampFirstPages:[]},c.__BUILD_MANIFEST.lowPriorityFiles=["/static/8V3TQEJtcpB3zmG4GiWhE/_buildManifest.js",,"/static/8V3TQEJtcpB3zmG4GiWhE/_ssgManifest.js"],c.__REACT_LOADABLE_MANIFEST=wt,c.__NEXT_FONT_MANIFEST=Pt,c.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var b={},y={};function _(n){var u=y[n];if(u!==void 0)return u.exports;var o=y[n]={exports:{}},v=!0;try{b[n](o,o.exports,_),v=!1}finally{v&&delete y[n]}return o.exports}_.m=b,_.amdO={},(()=>{var n=[];_.O=(u,o,v,E)=>{if(o){E=E||0;for(var d=n.length;d>0&&n[d-1][2]>E;d--)n[d]=n[d-1];n[d]=[o,v,E];return}for(var p=1/0,d=0;d<n.length;d++){for(var[o,v,E]=n[d],P=!0,w=0;w<o.length;w++)p>=E&&Object.keys(_.O).every(A=>_.O[A](o[w]))?o.splice(w--,1):(P=!1,E<p&&(p=E));if(P){n.splice(d--,1);var j=v();j!==void 0&&(u=j)}}return u}})(),_.n=n=>{var u=n&&n.__esModule?()=>n.default:()=>n;return _.d(u,{a:u}),u},_.d=(n,u)=>{for(var o in u)_.o(u,o)&&!_.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:u[o]})},_.e=()=>Promise.resolve(),_.g=function(){if(typeof i=="object")return i;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),_.o=(n,u)=>Object.prototype.hasOwnProperty.call(n,u),_.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},(()=>{var n={993:0};_.O.j=v=>n[v]===0;var u=(v,E)=>{var d,p,[P,w,j]=E,I=0;if(P.some(M=>n[M]!==0)){for(d in w)_.o(w,d)&&(_.m[d]=w[d]);if(j)var T=j(_)}for(v&&v(E);I<P.length;I++)p=P[I],_.o(n,p)&&n[p]&&n[p][0](),n[p]=0;return _.O(T)},o=c.webpackChunk_N_E=c.webpackChunk_N_E||[];o.forEach(u.bind(null,0)),o.push=u.bind(null,o.push.bind(o))})()})(),(c.webpackChunk_N_E=c.webpackChunk_N_E||[]).push([[720],{8819:ut,4337:ct,7960:ot,6914:_t,9548:st,5028:rt,9642:at,5105:nt,1651:tt,796:et,8949:Ze,7908:Qe,1583:Ye,8264:Ve,2039:ze,4363:Je,8439:We,5927:Ge,828:He,4834:Xe,4828:qe,6631:Be,8816:De,6991:Ue,7765:Le,8042:Me,335:Ke,3039:Fe,1863:Ce,989:Ae,9206:Te,9254:Ie,5577:Se,8219:je,6735:Oe,2594:we,2296:Pe,5228:Re,8983:$e,9182:Ne}]),(c.webpackChunk_N_E=c.webpackChunk_N_E||[]).push([[883],{676:Rt,5996:$t,2988:Nt,2561:Et,5234:vt,7983:yt,4591:bt,7444:ft,3665:mt,6776:xt,4101:lt,662:kt,7701:ht,9573:dt,7037:gt,3818:pt,1730:it}]),(c.webpackChunk_N_E=c.webpackChunk_N_E||[]).push([[668],{2067:Ee,6195:ve,7737:(b,y,_)=>{"use strict";_.r(y),_.d(y,{ComponentMod:()=>X,default:()=>H});var n={};_.r(n),_.d(n,{GET:()=>j,POST:()=>I,runtime:()=>w});var u={};_.r(u),_.d(u,{originalPathname:()=>B,patchFetch:()=>q,requestAsyncStorage:()=>M,routeModule:()=>T,serverHooks:()=>A,staticGenerationAsyncStorage:()=>C});var o=_(7983),v=_(2561),E=_(4828),d=_(6631),p=_(9985),P=_(7528);let w="edge";async function j(L){try{let N=(0,P.N)(),h=L.nextUrl.searchParams,F=h.get("page")||"1",R=h.get("limit")||"9",e=parseInt(F,10),s=parseInt(R,10);if(isNaN(e)||e<1)return p.xk.json({success:!1,message:"Invalid page parameter."},{status:400});if(isNaN(s)||s<1)return p.xk.json({success:!1,message:"Invalid limit parameter."},{status:400});let r=(e-1)*s,t=h.get("minPrice"),m=h.get("maxPrice"),g=h.get("duration"),O=h.get("maxPeople"),$=["is_active = 1"],f=[],k=1;if(t){let S=parseFloat(t);!isNaN(S)&&($.push(`base_price >= ?${k}`),f.push(S),k++)}if(m){let S=parseFloat(m);!isNaN(S)&&($.push(`base_price <= ?${k}`),f.push(S),k++)}if(g&&($.push(`duration = ?${k}`),f.push(g),k++),O){let S=parseInt(O,10);!isNaN(S)&&($.push(`(max_people IS NULL OR max_people >= ?${k})`),f.push(S),k++)}let U=$.length>0?`WHERE ${$.join(" AND ")}`:"",ee=`SELECT * FROM packages ${U} ORDER BY created_at DESC LIMIT ?${k} OFFSET ?${k+1}`,te=`SELECT COUNT(*) as total FROM packages ${U}`,ne=[...f,s,r],ae=[...f],re=N.prepare(te).bind(...ae),se=await re.first(),z=se?.total??0,_e=N.prepare(ee).bind(...ne),G=await _e.all();if(!G.success)throw console.error("Failed to fetch packages from D1:",G.error),Error("Database query failed to fetch packages.");let oe=G.results||[];return p.xk.json({success:!0,message:"Packages retrieved successfully",data:{packages:oe,pagination:{totalItems:z,currentPage:e,pageSize:s,totalPages:Math.ceil(z/s)}}})}catch(N){console.error("Error fetching packages:",N);let h={message:"Failed to retrieve packages",error:N instanceof Error?N.message:"An unknown error occurred"};return p.xk.json({success:!1,...h,data:null},{status:500})}}async function I(L){try{let N=(0,P.N)(),{name:h,description:F,duration:R,base_price:e,max_people:s,itinerary:r,included_services:t,images:m}=await L.json();if(!h||!R||e==null)return p.xk.json({success:!1,message:"Name, duration, and base price are required fields.",data:null},{status:400});if(typeof e!="number"||e<=0)return p.xk.json({success:!1,message:"Base price must be a positive number."},{status:400});if(s!=null&&(typeof s!="number"||s<=0))return p.xk.json({success:!1,message:"Max people must be a positive number if provided."},{status:400});let g=await N.prepare(`
        INSERT INTO packages (
          name, description, duration, base_price, max_people,
          created_by, itinerary, included_services, images, is_active,
          created_at, updated_at
        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
      `).bind(h,F??null,R,e,s??null,1,typeof r=="object"?JSON.stringify(r):r??null,typeof t=="object"?JSON.stringify(t):t??null,typeof m=="object"?JSON.stringify(m):m??null,1).run();if(!g.success||!g.meta?.last_row_id)throw console.error("Package insert failed, D1 result:",g),Error("Database operation failed to create package or return ID.");return p.xk.json({success:!0,message:"Package created successfully",data:{id:g.meta.last_row_id}},{status:201})}catch(N){console.error("Error creating package:",N);let h={message:"Error creating package",error:N instanceof Error?N.message:"An unknown error occurred"};return p.xk.json({success:!1,...h,data:null},{status:500})}}let T=new v.AppRouteRouteModule({definition:{kind:E.x.APP_ROUTE,page:"/api/packages/route",pathname:"/api/packages",filename:"route",bundlePath:"app/api/packages/route"},resolvedPagePath:"/home/chandra/andaman_website_CLI/andaman website CLI/src/app/api/packages/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:M,staticGenerationAsyncStorage:C,serverHooks:A}=T,B="/api/packages/route";function q(){return(0,d.XH)({serverHooks:A,staticGenerationAsyncStorage:C})}let X=u,H=o.a.wrap(T)},4155:ye,9985:be,7528:fe},b=>{var y=n=>b(b.s=n);b.O(0,[720,883],()=>y(7737));var _=b.O();(i._ENTRIES=typeof i._ENTRIES>"u"?{}:i._ENTRIES)["middleware_app/api/packages/route"]=_}]),function(){let b={exports:{},loaded:!1};return function(_,n){var u=Object.create,o=Object.defineProperty,v=Object.getOwnPropertyDescriptor,E=Object.getOwnPropertyNames,d=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,P=e=>o(e,"__esModule",{value:!0}),w=(e,s)=>{P(e);for(var r in s)o(e,r,{get:s[r],enumerable:!0})},j=(e,s,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let t of E(s))!p.call(e,t)&&t!=="default"&&o(e,t,{get:()=>s[t],enumerable:!(r=v(s,t))||r.enumerable});return e},I=e=>j(P(o(e!=null?u(d(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);w(n,{default:()=>N});var T=I((Y(),ge(D))),M="@next/request-context",C=Symbol.for(M),A=Symbol.for("internal.storage");function B(){let e=i;if(!e[C]){let s=new T.AsyncLocalStorage,r={get:()=>s.getStore(),[A]:s};e[C]=r}return e[C]}var q=B();function X(e,s){return q[A].run(e,s)}function H(e){let s={};return e&&e.forEach((r,t)=>{s[t]=r,t.toLowerCase()==="set-cookie"&&(s[t]=L(r))}),s}function L(e){let s=[],r=0,t,m,g,O,$;function f(){for(;r<e.length&&/\s/.test(e.charAt(r));)r+=1;return r<e.length}function k(){return m=e.charAt(r),m!=="="&&m!==";"&&m!==","}for(;r<e.length;){for(t=r,$=!1;f();)if(m=e.charAt(r),m===","){for(g=r,r+=1,f(),O=r;r<e.length&&k();)r+=1;r<e.length&&e.charAt(r)==="="?($=!0,r=O,s.push(e.substring(t,g)),t=r):r=g+1}else r+=1;(!$||r>=e.length)&&s.push(e.substring(t,e.length))}return s}function N(e){let s=e.staticRoutes.map(t=>({regexp:new RegExp(t.namedRegex),page:t.page})),r=e.dynamicRoutes?.map(t=>({regexp:new RegExp(t.namedRegex),page:t.page}))||[];return async function(t,m){let g=new URL(t.url).pathname,O={};if(e.nextConfig?.basePath&&g.startsWith(e.nextConfig.basePath)&&(g=g.replace(e.nextConfig.basePath,"")||"/"),e.nextConfig?.i18n)for(let f of e.nextConfig.i18n.locales){let k=new RegExp(`^/${f}($|/)`,"i");if(g.match(k)){g=g.replace(k,"/")||"/";break}}for(let f of s)if(f.regexp.exec(g)){O.name=f.page;break}if(!O.name){let f=F(g);for(let k of r||[]){if(f&&!F(k.page))continue;let U=k.regexp.exec(g);if(U){O={name:k.page,params:U.groups};break}}}let $=await X({waitUntil:m.waitUntil},()=>i._ENTRIES[`middleware_${e.name}`].default.call({},{request:{url:t.url,method:t.method,headers:H(t.headers),ip:h(t.headers,R.Ip),geo:{city:h(t.headers,R.City,!0),country:h(t.headers,R.Country,!0),latitude:h(t.headers,R.Latitude),longitude:h(t.headers,R.Longitude),region:h(t.headers,R.Region,!0)},nextConfig:e.nextConfig,page:O,body:t.body}}));return $.waitUntil&&m.waitUntil($.waitUntil),$.response}}function h(e,s,r=!1){let t=e.get(s)||void 0;return r&&t?decodeURIComponent(t):t}function F(e){return e==="/api"||e.startsWith("/api/")}var R;(function(e){e.City="x-vercel-ip-city",e.Country="x-vercel-ip-country",e.Ip="x-real-ip",e.Latitude="x-vercel-ip-latitude",e.Longitude="x-vercel-ip-longitude",e.Region="x-vercel-ip-country-region"})(R||(R={}))}(b,b.exports),b.exports}.call({}).default({name:"app/api/packages/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/about",regex:"^/about(?:/)?$",routeKeys:{},namedRegex:"^/about(?:/)?$"},{page:"/activities",regex:"^/activities(?:/)?$",routeKeys:{},namedRegex:"^/activities(?:/)?$"},{page:"/auth/signin",regex:"^/auth/signin(?:/)?$",routeKeys:{},namedRegex:"^/auth/signin(?:/)?$"},{page:"/auth/signup",regex:"^/auth/signup(?:/)?$",routeKeys:{},namedRegex:"^/auth/signup(?:/)?$"},{page:"/contact",regex:"^/contact(?:/)?$",routeKeys:{},namedRegex:"^/contact(?:/)?$"},{page:"/destinations",regex:"^/destinations(?:/)?$",routeKeys:{},namedRegex:"^/destinations(?:/)?$"},{page:"/favicon.ico",regex:"^/favicon\\.ico(?:/)?$",routeKeys:{},namedRegex:"^/favicon\\.ico(?:/)?$"},{page:"/packages",regex:"^/packages(?:/)?$",routeKeys:{},namedRegex:"^/packages(?:/)?$"},{page:"/search",regex:"^/search(?:/)?$",routeKeys:{},namedRegex:"^/search(?:/)?$"},{page:"/search-results",regex:"^/search\\-results(?:/)?$",routeKeys:{},namedRegex:"^/search\\-results(?:/)?$"},{page:"/user/bookings",regex:"^/user/bookings(?:/)?$",routeKeys:{},namedRegex:"^/user/bookings(?:/)?$"},{page:"/user/dashboard",regex:"^/user/dashboard(?:/)?$",routeKeys:{},namedRegex:"^/user/dashboard(?:/)?$"},{page:"/vendor/bookings",regex:"^/vendor/bookings(?:/)?$",routeKeys:{},namedRegex:"^/vendor/bookings(?:/)?$"},{page:"/vendor/dashboard",regex:"^/vendor/dashboard(?:/)?$",routeKeys:{},namedRegex:"^/vendor/dashboard(?:/)?$"},{page:"/vendor/login",regex:"^/vendor/login(?:/)?$",routeKeys:{},namedRegex:"^/vendor/login(?:/)?$"},{page:"/vendor/register",regex:"^/vendor/register(?:/)?$",routeKeys:{},namedRegex:"^/vendor/register(?:/)?$"},{page:"/vendor/services",regex:"^/vendor/services(?:/)?$",routeKeys:{},namedRegex:"^/vendor/services(?:/)?$"},{page:"/vendors",regex:"^/vendors(?:/)?$",routeKeys:{},namedRegex:"^/vendors(?:/)?$"}],dynamicRoutes:[{page:"/api/auth/[...nextauth]",regex:"^/api/auth/(.+?)(?:/)?$",routeKeys:{nxtPnextauth:"nxtPnextauth"},namedRegex:"^/api/auth/(?<nxtPnextauth>.+?)(?:/)?$"},{page:"/api/bookings/[id]",regex:"^/api/bookings/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/bookings/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/destinations/[id]",regex:"^/api/destinations/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/destinations/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/packages/[id]",regex:"^/api/packages/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/packages/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/api/vendors/[id]",regex:"^/api/vendors/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/api/vendors/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/bookings/confirmation/[id]",regex:"^/bookings/confirmation/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/bookings/confirmation/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/bookings/payment/[id]",regex:"^/bookings/payment/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/bookings/payment/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/destinations/[id]",regex:"^/destinations/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/destinations/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/packages/[id]",regex:"^/packages/([^/]+?)(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/packages/(?<nxtPid>[^/]+?)(?:/)?$"},{page:"/packages/[id]/book",regex:"^/packages/([^/]+?)/book(?:/)?$",routeKeys:{nxtPid:"nxtPid"},namedRegex:"^/packages/(?<nxtPid>[^/]+?)/book(?:/)?$"}],nextConfig:{basePath:""}})))(l,l,l);export{Ft as default};
